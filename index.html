<!DOCTYPE html>
<html lang="tr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Diyet | BaÅŸlangÄ±Ã§</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/style.css" />
  </head>
  <body>
    <main class="container">
      <header>
        <h1>ğŸ‘‹ Diyet</h1>
        <p>Supabase + Vercel + GitHub entegrasyonu ile baÅŸlatÄ±ldÄ±.</p>
      </header>
      <section class="card">
        <h2>HazÄ±r!</h2>
        <p>
          Bu, projenin basit karÅŸÄ±lama sayfasÄ±dÄ±r. CI/Lint/Test akÄ±ÅŸÄ± ve daÄŸÄ±tÄ±m
          altyapÄ±sÄ± kurulu. GeliÅŸtirmeye buradan devam edebilirsin.
        </p>
        <div class="actions">
          <a class="btn" href="https://github.com/sahinseyfi/Diyet" target="_blank" rel="noreferrer">GitHubâ€™da AÃ§</a>
          <a class="btn secondary" href="docs/configuration.md" target="_blank" rel="noreferrer">KonfigÃ¼rasyon</a>
          <button id="sentry-test" class="btn secondary" type="button">Sentry Test HatasÄ±</button>
          <button id="logtail-test" class="btn secondary" type="button">Logtail Test Logu</button>
        </div>
      </section>
      <footer>
        <span>Powered by Supabase Â· Vercel</span>
      </footer>
    </main>

    <!-- Sentry (Browser) CDN -->
    <script src="https://browser.sentry-cdn.com/7.120.0/bundle.tracing.min.js" crossorigin="anonymous"></script>
    <script>
      (async function () {
        try {
          const res = await fetch('/api/runtime-config');
          const cfg = await res.json();
          if (cfg && cfg.sentryDsn) {
            Sentry.init({
              dsn: cfg.sentryDsn,
              environment: cfg.environment || 'development',
              release: cfg.release || undefined,
              // APM Ã¶rnekleme oranÄ± (MVP iÃ§in dÃ¼ÅŸÃ¼k tut)
              tracesSampleRate: 0.2,
            });
            console.log('[sentry] initialized');
          } else {
            console.warn('[sentry] DSN bulunamadÄ±; Sentry devre dÄ±ÅŸÄ±');
          }
        } catch (e) {
          console.warn('[sentry] init hata', e);
        }

        // Test butonu tÄ±klanÄ±nca Ã¶rnek hata
        const btn = document.getElementById('sentry-test');
        if (btn) {
          btn.addEventListener('click', function () {
            try {
              // KasÄ±tlÄ± hata
              window.myUndefinedFunction();
            } catch (err) {
              if (window.Sentry) {
                Sentry.captureException(err);
                alert('Sentry test hatasÄ± gÃ¶nderildi (konsolu kontrol edin).');
              } else {
                alert('Sentry etkin deÄŸil (DSN ayarlÄ± mÄ±?).');
              }
            }
          });
        }

        // Logtail test
        const lt = document.getElementById('logtail-test');
        if (lt) {
          lt.addEventListener('click', async function () {
            try {
              const r = await fetch('/api/logtail-test');
              if (r.ok) {
                alert('Logtail test logu gÃ¶nderildi.');
              } else {
                alert('Logtail testi baÅŸarÄ±sÄ±z: ' + r.status);
              }
            } catch (e) {
              alert('Logtail isteÄŸi hata verdi.');
            }
          });
        }
      })();
    </script>
  </body>
  </html>
